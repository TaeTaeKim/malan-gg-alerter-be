# Malanalerter

**메이플랜드 서버의 아이템 가격 모니터링 및 알림 시스템**입니다. 메이플랜드 거래소를 자동으로 모니터링하여 설정한 조건에 맞는 아이템이 등록되면 디스코드로 알림을 보내줍니다.

## Malanalter란?

Malanalter는 메이플스토리 메이플랜드 서버 유저들을 위한 자동화된 거래소 알리미로:
- **특정 아이템 모니터링** - 메이플랜드 거래소(mapleland.gg)의 판매/구매 아이템 추적
- **실시간 디스코드 알림** - 가격 및 스탯 조건에 맞는 아이템 발견 시 즉시 알림
- **입찰 활동 추적** - 관심 있는 아이템의 입찰 현황 모니터링
- **다중 알림 관리** - 사용자 정의 필터링 조건으로 여러 아이템 알림 설정

## 개발 이유

메이플랜드 거래소에는 매일 수천 개의 아이템이 등록됩니다. 수동으로 거래소를 계속 확인하는 대신, Malanalter는:
- **시간 절약** - 24시간 자동 모니터링으로 시간 절약
- **기회 손실 방지** - 실시간 디스코드 알림으로 좋은 딜을 놓치지 않음
- **정확한 필터링** - 가격, 스탯 등 정확한 요구 사항 기반 필터링

## 기술 스택

### 핵심 프레임워크
- **Kotlin** 및 **Java 21** 런타임
- **Spring Boot 3.4.4** 애플리케이션 프레임워크
- **Kotlin Coroutines** 동시성 모니터링

### 데이터베이스 & ORM
- **PostgreSQL** 프로덕션 데이터 저장소
- **Exposed ORM** 타입 안전 데이터베이스 작업
- **H2** 테스트 환경용

### 인증 & 보안
- **Discord OAuth2** 사용자 인증 통합
- **Spring Security** 및 **JWT** 토큰
- 역할 기반 접근 제어로 보안 API 엔드포인트

### 외부 연동
- **Discord JDA** 봇 기능 및 알림
- **Spring Cloud OpenFeign** 메이플랜드 거래소 API 호출
- **Minio** 객체 저장소

### 테스팅
- **Kotest** 테스팅 프레임워크
- **MockK** 테스트용 모킹
- **Spring Boot Test** 통합 테스트

## 주요 기능

### 🔍 **아이템 모니터링**
- 메이플랜드 거래소 아이템 주기적 모니터링
- 가격대, 스탯(STR, DEX, INT, LUK), 공격력 등 사용자 정의 필터링
- 신규 등록 및 가격 변동 실시간 감지

### 🔔 **디스코드 연동**
- 간편한 디스코드 OAuth2 로그인
- 즉시 개인 메시지 알림
- 자동 디스코드 서버 연동
- 아이템별 알림 on/off 설정

### 📊 **입찰 추적**
- 추적 중인 아이템의 입찰 활동 모니터링
- 입찰 이력 데이터 저장
- 상위 5개 관련 입찰 표시
- 입찰 알림 관리

### 👤 **사용자 관리**
- 개인화된 알림이 있는 다중 사용자 지원
- 사용자 설정(알림 시간, 알림 선호도)
- 개별 제어가 가능한 사용자당 여러 알림

## 아키텍처 개요

```
MalanalterApplication
├── ItemCheckerV2 (예약된 모니터링 서비스)
├── AlertService (핵심 알림 관리)
├── MalanAlerterController (REST API 엔드포인트)
├── AuthController (디스코드 OAuth2 인증)
├── DiscordService (디스코드 봇 통합)
└── Repository Layer (Exposed ORM + PostgreSQL)
```

### 핵심 컴포넌트

- **ItemCheckerV2**: 코루틴을 사용한 동시 거래소 확인으로 모니터링 시스템의 핵심
- **MalanClient**: 메이플랜드 거래소 API와 인터페이스하는 Feign 클라이언트
- **AlertService**: 알림 등록, 업데이트, 디스코드 메시징 관리
- **DiscordService**: 모든 디스코드 봇 작업 및 알림 처리

## 작동 방식

1. **디스코드 OAuth2로 인증**
2. **REST API를 통해 모니터링할 아이템 등록**
3. **백그라운드 스케줄러**가 주기적으로 메이플랜드 거래소 확인
4. **조건에 맞는 아이템** 발견 시 자동으로 디스코드 알림 전송
5. **입찰 이력**을 PostgreSQL에 추적 및 저장